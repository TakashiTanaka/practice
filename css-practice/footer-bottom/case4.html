<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>flexBoxを使った方法</title>
	<style>
		* {
			padding: 0;
			margin: 0;
		}

		body {
			background: #bbb;
		}

		main {
			background-color: darkgreen;
			color: #fff;
			display: none;
			height: 2000px;
			text-align: center;
		}

		main.is-main-show {
			display: block;
		}

		footer {
			bottom: 0;
			width: 100%;
			text-align: center;
			background: #333;
			opacity: 0.8;
			color: #fff;
			padding: 3em 0;
		}
	</style>
</head>

<body>
	<button id="btn">コンテンツ量を増やす</button>
	<main id="content">
		コンテンツ
	</main>
	<footer id="footer">footer</footer>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"
		integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script>
		// footerの処理
		const fixedFooter = () => {
			let $ftr = $('#footer');

			// これは初期化処理。コンテンツ量が動的に増えたりしない場合は不要
			$ftr.attr({ 'style': 'position:""; top:"";' });

			// 1. ブラウザの高さとブラウザの上辺からfooterの上辺までの距離 + footerの高さを比較する
			// 2. もしブラウザの高さがブラウザの上辺からfooterの上辺までの距離 + footerの高さよりも高かったら処理を実行する
			if (window.innerHeight > $ftr.offset().top + $ftr.outerHeight()) {
				// 3. 処理の内容はfooterのpositionをfixedに、topをwindow.innerHeight - footerの高さに設定する
				$ftr.attr({ 'style': 'position:fixed; top:' + (window.innerHeight - $ftr.outerHeight()) + 'px;' });
			}

		}

		// 読み込み時に実行
		fixedFooter();

		// リサイズ時にも実行する
		window.addEventListener("resize", fixedFooter);

		// テスト用のイベント
		btn.addEventListener('click', e => {
			content.classList.toggle('is-main-show');
			fixedFooter();
			console.log(e.target.innerText)
			if (e.target.innerText == "コンテンツ量を増やす") {
				e.target.innerText = "コンテンツ量を減らす";
			} else {
				e.target.innerText = "コンテンツ量を増やす";
			}
		});
	</script>
</body>

</html>